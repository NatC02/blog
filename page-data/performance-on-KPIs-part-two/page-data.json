{"componentChunkName":"component---src-templates-blog-post-js","path":"/performance-on-KPIs-part-two/","result":{"data":{"site":{"siteMetadata":{"title":"Natan Ceballos Blog"}},"markdownRemark":{"id":"3330736a-f25e-5975-ab66-8ff183646037","excerpt":"This post is a continuation of performance metrics and Key Performance Indicators. These are the rest of the performance metrics to be aware of, so let’s get…","html":"<p>This post is a continuation of performance metrics and Key Performance Indicators. These are the rest of the performance metrics to be aware of, so let’s get right to it.</p>\n<h1><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Layout_Instability_API\">Cumulative Layout Shift (CLS)</a></h1>\n<p>The cumulative layout shift score metric is the sum of all unexpected layout shifts that occur from the time the page first loads and the time its lifecycle state goes to hidden. The Cumulative Layout Shift (CLS) is an important user-centric metric for gauging visual stability since it quantifies how often users experience unexpected layout shifts—a low CLS indicates that the page is enjoyable.</p>\n<p>Improving CLS can improve ad revenue. iCook improved CLS by 15% and saw a 10% increase in ad revenue as a result.</p>\n<h2>CLS in 2021</h2>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-CLS-by-device.png\">\n<p>Because CLS is defined by how much layout shift a user perceives rather than how long it takes to visually see something like FCP and LCP, its performance across devices was very consistent.</p>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-CLS-by-ect.png\">\n<p>In comparison to FCP and LCP, performance loss from 4G to 3G and below was not as noticeable. There is some loss, but it isn’t shown in the device data; only the connection type is affected. Of all connection types, offline websites had the best CLS performance. Some assets, such as photos and advertising, that might otherwise cause layout alterations may not be cached on sites with service worker caching. As a result, they’d never load and would never trigger a layout shift. More basic versions of the online website are frequently used as fallback HTML for these sites.</p>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-CLS-by-rank.png\">\n<p>For the top 10,000 websites, CLS performance revealed an unusual dip. Furthermore, all of the rated groups above 1Million (M) outperformed the sites ranked below 1M. The sub-1M group performs better since the “all” group outperformed all of the other ranking groupings. </p>\n<p>The sub-1M group performs better since the “all” group outperformed all of the other ranking groupings. WordPress may have played a hand in this metric and others again, since 60% of WordPress-based origins had a good CLS.</p>\n<h2>Tips for Improvement</h2>\n<p>Reserving space for images using CSS-grid is a notable performance improvement. I love me <a href=\"https://css-tricks.com/a-responsive-grid-layout-with-no-media-queries/\">some css grid tricks</a></p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Same fit image in grid<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n<span class=\"token selector\">.grid</span> <span class=\"token punctuation\">{</span> \n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> grid<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">grid-template-columns</span><span class=\"token punctuation\">:</span> <span class=\"token function\">repeat</span><span class=\"token punctuation\">(</span>auto-fill<span class=\"token punctuation\">,</span> <span class=\"token function\">minmax</span><span class=\"token punctuation\">(</span>200px<span class=\"token punctuation\">,</span> 1fr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">grid-gap</span><span class=\"token punctuation\">:</span> 20px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> stretch<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.grid img</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #ccc<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 2px 2px 6px 0px  <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">,</span>0<span class=\"token punctuation\">,</span>0<span class=\"token punctuation\">,</span>0.3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>main</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>grid<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sample1.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sample photo one<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sample2.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sample photo two<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sample3.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sample photo three<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sample4.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sample photo four<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sample5.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sample photo five<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>sample6.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Sample photo six<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>main</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This implementation holds the images inside the grid areas and resizes them using <code class=\"language-text\">grid-template-columns</code> and <code class=\"language-text\">align-items</code> stretch property. This is only one of many improvements that can be implemented. Gains for improving performance for CLS can come from eliminating text-shifts when web fonts are loaded, top banners being inserted after the <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/First_paint\">First Paint</a>, <a href=\"https://cocolyze.com/en/seo-glossary/non-composited-animations\">non-composited animations and iframes</a>.</p>\n<h2>First Input Delay (FID)</h2>\n<p>The time between when a user interacts with your site for the first time (i.e. when they click a link, push a button, or utilize a custom, JavaScript-powered control) and when the browser is able to respond to that interaction is known as the First Input Delay. In other terms, it is the time interval between the initial user interaction on a web page and the browser’s reaction to that interaction, measured in milliseconds. This measure does not take into account scrolling or zooming.</p>\n<p>Reducating FID can yield mobile ad revenue. Swappie reduced their FID by 90% (among others) and saw a 42% increase in mobile revenue and a 10 percentage point increase in relative mobile conversion rate.</p>\n<h3>FID in 2021</h3>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-FID-by-device.png\">\n<p>FID performance on desktops was higher than on mobile devices, thanks to faster device speeds that can execute and handle large JavaScript better.</p>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-FID-by-ect.png\">\n<p>The performance of FID was affected by connection type to some extent, although not as much as the other measures. The wide range of scores seems to limit the amount of variation in the outcomes. FID was worse for offline websites than every other connection category, unlike the other parameters. This might be owing to the fact that many websites with service workers are more complex.</p>\n<p>Also to note is that the impact of client-side JavaScript executing on the <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Main_thread\">main thread</a> is not mitigated by using a service worker.</p>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-FID-by-rank.png\">\n<p>FID’s rank-based performance was flat. We see very huge bars in the “good” category for all FID measures, making it less beneficial until we’ve genuinely reached peak performance.</p>\n<h3>Performance improvement tip</h3>\n<p>Having small bundle sizes and third-party scripts increases the FID metric. The most common improvement is to reduce long-running Javascript.</p>\n<h3>[Note: Offset your Third Party Scripts to a Web Worker by using partytown] town(<a href=\"https://github.com/BuilderIO/partytown\">https://github.com/BuilderIO/partytown</a>).</h3>\n<h2>Total Blocking Time (TBT)</h2>\n<p>The time between FCP and TTI is known as Total Blocking Time. This is the time where the main thread is blocked and prevents responsive input.  Because it measures load responsiveness, Total Blocking Time is an high priority metric. The degree of how non-interactive a page is before it becomes effectively interactive is measured by load responsiveness—a low TBT ensures that the page is functional.</p>\n<p>Web Vitals optimized Mercado Libre (TBT included). In order to test and enhance the interactivity of product detail pages in the real world, TBT was used as a proxy metric in the lab. [They optimized the product detail pages’ interaction for a 90% reduction in Max Potential FID in Lighthouse and a 9% improvement in FID in Chrome User Experience Report (2020)]. (<a href=\"https://web.dev/how-mercadolibre-optimized-web-vitals/\">https://web.dev/how-mercadolibre-optimized-web-vitals/</a>).</p>\n<h2>TBT in 2021</h2>\n<p>TBT is only available in Mobile. </p>\n<img src=\"https://almanac.httparchive.org/static/images/2021/performance/performance-tbt.png\">\n<p>WebPageTest does not represent real-world user experiences, therefore the data comes from a single throttled-CPU Lighthouse run. When comparing TBT to FID, however, actual interactivity was shown to be much poorer. According to Web Almanac,   the “real” assessment interaction is somewhere in the center. Whether your FID is “good,” they recommend looking at TBT to determine if you’re missing any unpleasant user experiences that FID isn’t picking up on. The same issues that create bad FID also cause poor TBT.</p>\n<h2>Tips for improvement</h2>\n<ol>\n<li>Cutting JavaScript execution time <br/></li>\n<li>Replacing huge JavaScript libraries with smaller equivalents &#x3C;br</li>\n<li>Discarding any JavaScript that is no longer in use <br/></li>\n<li>Minimizing the impact of third-party code</li>\n</ol>\n<h2>Closing Thoughts</h2>\n<p>These last 3 performance metrics are important because they lead to a better internet for everyone. They also notably improve KPIs, in my future projects I will keep these in mind.</p>\n<br/>\n<br/>\n<h2>Resources</h2>\n<p><a href=\"https://web.dev/user-centric-performance-metrics/\">User centric performance metrics</a></p>\n<p><a href=\"https://almanac.httparchive.org/static/pdfs/web_almanac_2021_en.pdf\">State of the web</a></p>","frontmatter":{"title":"Analyzing performance metrics and improvements on KPIs (Part Two)","date":"April 16, 2022","description":"Part two of performance metrics on KPIs and improvements"}}},"pageContext":{"slug":"/performance-on-KPIs-part-two/","previous":{"fields":{"slug":"/performance-on-KPIs-part-one/"},"frontmatter":{"title":"Analyzing performance metrics and improvements on KPIs (Part One)"}},"next":null}},"staticQueryHashes":["2915217059","805692932"]}